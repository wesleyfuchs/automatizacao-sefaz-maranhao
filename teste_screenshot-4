from selenium import webdriver
from selenium.webdriver.common.by import By
from PIL import Image
import pytesseract

# Certifique-se de configurar o caminho para o executável do Tesseract no seu sistema
# pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract.exe'

# Configuração do Selenium
driver = webdriver.Chrome()  # Você pode precisar baixar o driver do navegador adequado para o seu sistema
driver.get("https://example.com")  # Substitua pela URL da sua página

# Localize o elemento usando seletor CSS ou XPath
elemento = driver.find_element(By.CSS_SELECTOR, "seletor_css_do_seu_elemento")

# Obtenha as coordenadas do elemento
posicao = elemento.location
tamanho = elemento.size

# Captura uma screenshot da área do elemento
screenshot = driver.get_screenshot_as_png()
image = Image.open(io.BytesIO(screenshot))

# Calcula as coordenadas da região
x1, y1, x2, y2 = posicao['x'], posicao['y'], posicao['x'] + tamanho['width'], posicao['y'] + tamanho['height']

# Corta a imagem para a região específica
imagem_cortada = image.crop((x1, y1, x2, y2))

# Salva a imagem cortada
imagem_cortada.save('screenshot.png')

# Usa o Tesseract para fazer OCR na imagem cortada
texto_ocr = pytesseract.image_to_string(imagem_cortada)

# Imprime o texto reconhecido
print("Texto OCR:", texto_ocr)

# Continue com o restante do seu código...

# Feche o navegador
driver.quit()
