import pygetwindow as gw
import pyautogui
import time
import pytesseract
from PIL import Image

# Certifique-se de configurar o caminho para o executável do Tesseract no seu sistema
# pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract.exe'

# ... Seu código existente para automatizar ações na página web ...

# Aguarde um breve momento para que o conteúdo seja renderizado na tela
time.sleep(1)

# Obtenha a janela ativa (assumindo que seu navegador ou aplicativo tenha o foco)
janela_ativa = gw.getActiveWindow()

# Obtenha as coordenadas da janela ativa
x1, y1, x2, y2 = janela_ativa.left, janela_ativa.top, janela_ativa.right, janela_ativa.bottom

# Captura uma imagem da região específica da tela
screenshot = pyautogui.screenshot('screenshot.png', region=(x1, y1, x2 - x1, y2 - y1))

# Carrega a imagem usando a biblioteca PIL (Pillow)
image = Image.open('screenshot.png')

# Usa o Tesseract para fazer OCR na imagem
texto_ocr = pytesseract.image_to_string(image)

# Imprime o texto reconhecido
print("Texto OCR:", texto_ocr)

# Continue com o restante do seu código...
