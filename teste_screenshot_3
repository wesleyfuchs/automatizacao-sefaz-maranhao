import pyautogui
import pytesseract
from PIL import Image

# Certifique-se de configurar o caminho para o executável do Tesseract no seu sistema
# pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract.exe'

# ... Seu código existente para automatizar ações na página web ...

# Obtem as coordenadas atuais do cursor
x, y = pyautogui.position()

# Define o tamanho da região a ser capturada ao redor do cursor
tamanho_regiao = 100

# Calcula as coordenadas da região
x1 = max(0, x - tamanho_regiao // 2)
y1 = max(0, y - tamanho_regiao // 2)
x2 = x1 + tamanho_regiao
y2 = y1 + tamanho_regiao

# Captura uma imagem da região específica da tela
screenshot = pyautogui.screenshot('screenshot.png', region=(x1, y1, x2 - x1, y2 - y1))

# Carrega a imagem usando a biblioteca PIL (Pillow)
image = Image.open('screenshot.png')

# Usa o Tesseract para fazer OCR na imagem
texto_ocr = pytesseract.image_to_string(image)

# Imprime o texto reconhecido
print("Texto OCR:", texto_ocr)

# Continue com o restante do seu código...
